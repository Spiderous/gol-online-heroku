(function(e){function t(t){for(var i,o,s=t[0],c=t[1],l=t[2],h=0,f=[];h<s.length;h++)o=s[h],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],i=!0,s=1;s<r.length;s++){var c=r[s];0!==n[c]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=r[0]))}return e}var i={},n={app:0},a=[];function o(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=i,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(r,i,function(t){return e[t]}.bind(null,i));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},1:function(e,t){},"11ed":function(e,t,r){},"5c0b":function(e,t,r){"use strict";var i=r("9c0c"),n=r.n(i);n.a},"61f6":function(e,t,r){"use strict";var i=r("11ed"),n=r.n(i);n.a},"9c0c":function(e,t,r){},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var i,n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},o=[],s=(r("5c0b"),r("2877")),c={},l=Object(s["a"])(c,a,o,!1,null,null,null),u=l.exports,h=r("8c4f"),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"game"},[e.patternCreator.isOpen?r("section",{staticClass:"creator"},[r("h1",{staticClass:"creator-header"},[e._v("Kreator struktur")]),r("ul",{staticClass:"creator-grid"},e._l(e.patternCreator.grid,(function(t,i){return r("ul",{key:i,staticClass:"grid-row"},e._l(e.patternCreator.grid[i],(function(t,n){return r("ul",{key:n,staticClass:"grid-col"},[r("li",{staticClass:"grid-cell",class:e.patternCreator.grid[i][n]?"activated":"",on:{click:function(t){return e.patternCreator.toggleCell(i,n)}}})])})),0)})),0),r("div",{staticClass:"creator-actions"},[r("button",{staticClass:"action_choose-pattern",on:{click:function(t){return e.patternCreator.choosePattern()}}},[e._v("Dodaj strukturę")]),r("button",{staticClass:"action_close-creator",on:{click:function(t){return e.patternCreator.closeCreator()}}},[e._v("Wyjdź z kreatora")])])]):e._e(),r("main",{staticClass:"main-content"},[r("div",{staticClass:"game-wrapper"},[r("div",{staticClass:"floating-actions"},[r("button",{staticClass:"action_open-creator",on:{click:function(t){e.patternCreator.isOpen?e.patternCreator.closeCreator():e.patternCreator.openCreator()}}},[e._v(e._s(e.patternCreator.isOpen?"Zamknij kreator":"Otwórz kreator"))])]),r("v-touch",{on:{touch:function(t){return e.console.log("xd")}}},[r("canvas",{ref:"canvas",on:{mousemove:e.mouseMove,click:e.canvasClick,mousedown:e.mouseDown,mouseup:e.mouseUp}})])],1)])])},d=[],g=(r("a4d3"),r("4de4"),r("4160"),r("e439"),r("dbb4"),r("b64b"),r("159b"),r("ade3")),p=r("bee2"),m=r("99de"),v=r("7e84"),C=r("257e"),b=r("262e"),y=r("d4ec"),k=r("9ab4"),O=r("60a3"),w=r("8055"),G=r.n(w),S=function(){function e(t){Object(y["a"])(this,e),this._creatorOpen=!1,this._placingPattern=!1,this._grid=[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]],this._instance=t}return Object(p["a"])(e,[{key:"resetGrid",value:function(){for(var e=0;e<this._grid.length;e++)for(var t=0;t<this._grid[e].length;t++)this._instance.$set(this._grid[e],t,0)}},{key:"openCreator",value:function(){this._creatorOpen=!0,this._placingPattern=!1}},{key:"closeCreator",value:function(){this._creatorOpen=!1,this._placingPattern=!1}},{key:"choosePattern",value:function(){this._creatorOpen=!1,this._placingPattern=!0}},{key:"toggleCell",value:function(e,t){this._instance.$set(this._grid[e],t,this._grid[e][t]?0:1)}},{key:"grid",get:function(){return this._grid}},{key:"isOpen",get:function(){return this._creatorOpen}},{key:"isPlacing",get:function(){return this._placingPattern}}]),e}();function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){Object(g["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}(function(e){e[e["LOADING"]=0]="LOADING",e[e["PREPARED"]=1]="PREPARED",e[e["RUNNING"]=2]="RUNNING"})(i||(i={}));var j=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(m["a"])(this,Object(v["a"])(t).apply(this,arguments)),e.patternCreator=new S(Object(C["a"])(e)),e.gameState=i.LOADING,e.camera={offsetX:0,offsetY:0},e.mouseCursor={overCell:{col:-1,row:-1},clickPos:{x:0,y:0},dragging:!1},e.isDev=!1,e.devPort=2e3,e.canvasRatio=16/9,e.responsiveSm=600,e}return Object(b["a"])(t,e),Object(p["a"])(t,[{key:"created",value:function(){this.socket=G()(this.isDev?"http://localhost:".concat(this.devPort):""),this.handleSocketConnection()}},{key:"mounted",value:function(){var e=this;this.context=this.$refs.canvas.getContext("2d"),window.addEventListener("resize",(function(){e.resizeCanvas()}))}},{key:"handleSocketConnection",value:function(){var e=this;this.socket.on("init_pack",(function(t){e.gameGrid=P({},t),e.resizeCanvas(),e.camera.offsetX=(e.context.canvas.width-e.gameGrid.dimensions.cols*e.gameGrid.cellSize)/2,e.camera.offsetY=(e.context.canvas.height-e.gameGrid.dimensions.rows*e.gameGrid.cellSize)/2,e.gameState=i.RUNNING,e.renderGame()})),this.socket.on("update_pack",(function(t){e.gameGrid.currentGen=t.currentGen,e.gameGrid.currentIteration=t.currentIteration}))}},{key:"resizeCanvas",value:function(){var e=(window.innerWidth<this.responsiveSm?1:.8)*window.innerWidth,t=window.innerHeight<e/this.canvasRatio||window.innerWidth<this.responsiveSm?window.innerHeight:e/this.canvasRatio;this.context.canvas.width=e,this.context.canvas.height=t,this.canvasWidth=e,this.canvasHeight=t}},{key:"mouseMove",value:function(e){if(this.gameState==i.RUNNING){var t=this.context.canvas.getBoundingClientRect();this.mouseCursor.overCell.col=Math.floor((e.pageX-this.camera.offsetX-t.left)/this.gameGrid.cellSize),this.mouseCursor.overCell.row=Math.floor((e.pageY-this.camera.offsetY-t.top)/this.gameGrid.cellSize),this.mouseCursor.dragging&&(this.camera.offsetX=e.pageX-this.mouseCursor.clickPos.x,this.camera.offsetY=e.pageY-this.mouseCursor.clickPos.y)}}},{key:"mouseDown",value:function(e){this.gameState==i.RUNNING&&(this.patternCreator.isPlacing||(this.mouseCursor.clickPos.x=e.pageX-this.camera.offsetX,this.mouseCursor.clickPos.y=e.pageY-this.camera.offsetY,this.mouseCursor.dragging=!0))}},{key:"mouseUp",value:function(e){this.gameState==i.RUNNING&&(this.mouseCursor.dragging=!1)}},{key:"canvasClick",value:function(e){this.gameState==i.RUNNING&&!this.patternCreator.isOpen&&this.patternCreator.isPlacing&&(this.socket.emit("create_pattern",{pattern:this.patternCreator.grid,offsetRow:this.mouseCursor.overCell.row-2,offsetCol:this.mouseCursor.overCell.col-2}),this.patternCreator.resetGrid(),this.patternCreator.closeCreator())}},{key:"renderGame",value:function(){if(this.gameState==i.RUNNING){this.context.fillStyle="#333",this.context.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.context.save(),this.context.transform(1,0,0,1,this.camera.offsetX,this.camera.offsetY),this.context.lineWidth=1,this.context.strokeStyle="gray";for(var e=0;e<this.gameGrid.dimensions.cols;e++)for(var t=0;t<this.gameGrid.dimensions.rows;t++){var r=this.gameGrid.currentGen[e][t];this.context.fillStyle=r?"black":"white",this.context.fillRect(e*this.gameGrid.cellSize,t*this.gameGrid.cellSize,this.gameGrid.cellSize,this.gameGrid.cellSize),this.context.strokeRect(e*this.gameGrid.cellSize,t*this.gameGrid.cellSize,this.gameGrid.cellSize,this.gameGrid.cellSize)}var n=!1;if(this.patternCreator.isPlacing){this.context.fillStyle="green";for(var a=0;a<this.patternCreator.grid.length;a++)for(var o=0;o<this.patternCreator.grid.length;o++){var s=(this.mouseCursor.overCell.col+o-2)*this.gameGrid.cellSize,c=(this.mouseCursor.overCell.row+a-2)*this.gameGrid.cellSize;if(1==this.patternCreator.grid[a][o]){if(c<0||c>=this.gameGrid.dimensions.gameHeight){n=!0;continue}if(s<0||s>=this.gameGrid.dimensions.gameWidth){n=!0;continue}this.context.fillRect(s,c,this.gameGrid.cellSize,this.gameGrid.cellSize)}}this.context.strokeStyle=n?"red":"black",this.context.lineWidth=2,this.context.strokeRect((this.mouseCursor.overCell.col-2)*this.gameGrid.cellSize,(this.mouseCursor.overCell.row-2)*this.gameGrid.cellSize,5*this.gameGrid.cellSize,5*this.gameGrid.cellSize)}this.context.restore(),requestAnimationFrame(this.renderGame)}else requestAnimationFrame(this.renderGame)}}]),t}(O["b"]);j=k["a"]([O["a"]],j);var x=j,N=x,z=(r("61f6"),Object(s["a"])(N,f,d,!1,null,"81bb775c",null)),R=z.exports;n["a"].use(h["a"]);var D=[{path:"/",name:"home",component:R}],I=new h["a"]({routes:D}),U=I,E=r("2f62");n["a"].use(E["a"]);var W=new E["a"].Store({state:{},mutations:{},actions:{},modules:{}}),X=r("ca95");n["a"].config.productionTip=!1,n["a"].use(X),new n["a"]({router:U,store:W,render:function(e){return e(u)}}).$mount("#app")}});
//# sourceMappingURL=app.b4e384df.js.map